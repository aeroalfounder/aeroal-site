function searchFlight() {
  const from = document.getElementById("from").value;
  const to = document.getElementById("to").value;
  const date = document.getElementById("date").value;
  const flightClass = document.getElementById("class").value;
  const routeKey = `${from} → ${to}`;
  const routePrices = pricesByRoute[routeKey];
  let priceText = "";

  if (routePrices && routePrices[flightClass]) {
    const usdBase = routePrices[flightClass];

    // Скидка 10% при бронировании за 30+ дней
    const flightDate = new Date(date);
    const today = new Date();
    const daysBefore = Math.ceil((flightDate - today) / (1000 * 60 * 60 * 24));
    let discount = 0;

    if (daysBefore > 30) {
      discount = 0.1; // 10%
    }

    const finalUsd = usdBase * (1 - discount);
    const finalRobux = Math.round(finalUsd * 8);
    priceText = `Цена: $${finalUsd.toFixed(2)} | R$ ${finalRobux}`;
    if (discount > 0) {
      priceText += " (скидка 10%)";
    }
  } else {
    priceText = "Цена: недоступна";
  }

  const resultText = date
    ? `✅ Рейс: ${routeKey} на ${date}\nКласс: ${flightClass} | ${priceText}`
    : "❌ Выберите дату!";

  document.getElementById("searchResult").innerText = resultText;
  document.getElementById("buyButton").style.display = date ? "inline-block" : "none";

  const planeBlock = document.getElementById("planeBlock");
  if (date && flights[from] && flights[from][to]) {
    document.getElementById("planeInfo").innerText = `Самолёт: ${flights[from][to]}`;
    planeBlock.style.display = "block";
  } else {
    planeBlock.style.display = "none";
  }
}